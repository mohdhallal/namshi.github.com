
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Innovate Payment Gateway Library - Tech @ Namshi.com</title>
  <meta name="author" content="Namshi">

  
  <meta name="description" content="In the tech Namshi team, as you probably know, we fully support the open source movement,
that&rsquo;s why we try to release open source software as &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://namshi.github.io/blog/2014/09/02/innovate-payment-gate-way-library">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Tech @ Namshi.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<script type="text/javascript">
//<![CDATA[
  (function() {
    var shr = document.createElement('script');
    shr.setAttribute('data-cfasync', 'false');
    shr.src = '//dsms0mj1bbhn4.cloudfront.net/assets/pub/shareaholic.js';
    shr.type = 'text/javascript'; shr.async = 'true';
    shr.onload = shr.onreadystatechange = function() {
      var rs = this.readyState;
      if (rs && rs != 'complete' && rs != 'loaded') return;
      var site_id = 'cd6fa3364ca85c66b5dc6d0c13e7fde9';
      try { Shareaholic.init(site_id); } catch (e) {}
    };
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(shr, s);
  })();
//]]>
</script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44619227-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:namshi.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Innovate Payment Gateway Library</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-02T19:23:00+04:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In the tech <a href="https://namshi.com">Namshi</a> team, as you probably know, we fully support the open source movement,
that&rsquo;s why we try to release open source software as soon as we can, in the full &ldquo;give back to the community&rdquo; mindset.
You can check all our project on <a href="http://github.com/namshi">github</a></p>

<p>Lots of e-commerce companies and service providers have online payments for their
customers. So do we.</p>

<p>Our weapon of choice, apart from PayPal, to carry out payments is: <a href="http://www.innovatepayments.com">Innovate.</a>
That&rsquo;s why we developed and released the <a href="https://github.com/namshi/innovate">Innovate library</a>, written in PHP.</p>

<p><a href="http://www.innovatepayments.com">Innovate</a> payment gateway accepts all types of credit card payments.</p>

<!-- more -->


<h2>Installation</h2>

<p>You can easily integrate the Innovate library in your project via <a href="https://getcomposer.org">composer</a>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>composer install namshi/innovate</span></code></pre></td></tr></table></div></figure>


<p><img class="center" src="/images/posts/cards.png" title="payment cards" ></p>

<h2>Usage</h2>

<p>Using this library is easy, here is what you need:</p>

<ul>
<li>initialize the Innovate client</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\Transaction</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\BillingInformation</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\Browser</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\Billing\Customer</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\Billing\Address</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Payment\Card</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Client</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$client</span>      <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="nv">$storeId</span><span class="p">,</span> <span class="nv">$authenticationKey</span><span class="p">);</span> <span class="c1">// retrieve them from your Innovate account</span>
</span><span class='line'><span class="nv">$transaction</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Transaction</span><span class="p">(</span><span class="s1">&#39;sale&#39;</span><span class="p">,</span> <span class="s1">&#39;ecom&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="s1">&#39;ORDER_NUMBER&#39;</span><span class="p">,</span> <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;AN OPTIONAL REFERENCE TO YOUR TRANSACTION&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$card</span>        <span class="o">=</span> <span class="k">new</span> <span class="nx">Card</span><span class="p">(</span><span class="s1">&#39;1234123412341234&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(</span><span class="nv">$cardExpiryDate</span><span class="p">));</span>
</span><span class='line'><span class="nv">$customer</span>    <span class="o">=</span> <span class="k">new</span> <span class="nx">Customer</span><span class="p">(</span><span class="s1">&#39;Mr&#39;</span><span class="p">,</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Doe&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$address</span>     <span class="o">=</span> <span class="k">new</span> <span class="nx">Address</span><span class="p">(</span><span class="s1">&#39;My address info 1&#39;</span><span class="p">,</span> <span class="s1">&#39;My address info 2&#39;</span><span class="p">,</span> <span class="s1">&#39;My address info 3&#39;</span><span class="p">,</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;00000&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$billing</span>     <span class="o">=</span> <span class="k">new</span> <span class="nx">BillingInformation</span><span class="p">(</span><span class="nv">$customer</span><span class="p">,</span> <span class="nv">$address</span><span class="p">,</span> <span class="s2">&quot;customers&#39;s-email@gmail.com&quot;</span><span class="p">,</span> <span class="nv">$customerIpAddress</span><span class="p">);</span>
</span><span class='line'><span class="nv">$browser</span>     <span class="o">=</span> <span class="k">new</span> <span class="nx">Browser</span><span class="p">(</span><span class="nv">$customUserAgent</span><span class="p">,</span> <span class="nv">$requestAcceptHeader</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>We used OOP to cover all the data we need to send to Innovate:</p>

<p><code>$client</code> is a model that contains the Innovate account info.</p>

<p><code>$transaction</code> represents a detailed transaction where we pass as many arguments as Innovate needs.</p>

<p><code>$card</code> represents the required card details to perform the payment.</p>

<p><code>$customer</code> represents the customer details.</p>

<p><code>$address</code> represents the customer address details.</p>

<p><code>$billing</code> represents the customer billing address and contact details.</p>

<p><code>$browser</code> represents detailed browser info, including the User-Agent.</p>

<p><code>$customUserAgent</code> is the browser user agent header.</p>

<p><code>$requestAcceptHeader</code> is the browser accept header.</p>

<h2>How It Works</h2>

<p>To perform the payment you need to create a request to <a href="http://www.innovatepayments.com">Innovate</a> and pass the previous created objects:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">performPayment</span><span class="p">(</span><span class="nv">$transaction</span><span class="p">,</span> <span class="nv">$card</span><span class="p">,</span> <span class="nv">$billing</span><span class="p">,</span> <span class="nv">$browser</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>You will then get one of the following responses:</p>

<ul>
<li><h2>Normal transaction</h2>

<p>A normal transaction follows a very simple flow: It just requires authentication through Innovate, and the library then performs the payment.</p></li>
<li><h2>3D secure transactions</h2>

<p>A <a href="http://en.wikipedia.org/wiki/3-D_Secure">3-D_Secure</a> transaction requires two requests to Innovate and one request for 3D Secure in order
to add an additional security layer while performing the payment.
The first request is already sent to Innovate and if it is 3D Secure transaction you will need to redirect the user to the concerned party
(primarily, the bank) to confirm the payment.</p></li>
</ul>


<p>After that the process continues by sending another request to Innovate containing the extra validation values.</p>

<p>You can easily distinguish between the two possible types of payments, 3D Secure and Normal, by looking at the type of Innovate response received:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="k">use</span> <span class="nx">Namshi\Innovate\Http\Response\Redirect</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">performPayment</span><span class="p">(</span><span class="nv">$transaction</span><span class="p">,</span> <span class="nv">$card</span><span class="p">,</span> <span class="nv">$billing</span><span class="p">,</span> <span class="nv">$browser</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$response</span> <span class="nx">instanceOf</span> <span class="nx">Redirect</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// 3D secure transactions</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Normal transactions</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In case of normal Transactions, the library will perform the payment directly.
In case of 3D Secure transactions you need to send another request
with more details (related to the third security party) as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="k">use</span> <span class="nx">Namshi\Innovate\Http\Response\Redirect</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$response</span> <span class="nx">instanceof</span> <span class="nx">Redirect</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// build a form</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The response object contains the values (&lsquo;targetUrl&rsquo;, &lsquo;session&rsquo;, &lsquo;paReq&rsquo;) which are needed to build the form:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$targetUrl</span>  <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getTargetUrl</span><span class="p">();</span>
</span><span class='line'><span class="nv">$session</span>    <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">();</span>
</span><span class='line'><span class="nv">$pareq</span>      <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getPareq</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, the receiving the previous values will be used to build a form as hidden values.
The form will be sent to the <code>$targetUrl</code> which is the 3D-secure service page as the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;form</span> <span class="na">name=</span><span class="s">&quot;acsform&quot;</span> <span class="na">action=</span><span class="s">&quot;[targetUrl from the response]&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;PaReq&quot;</span> <span class="na">value=</span><span class="s">&quot;[The pareq data from response]&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;MD&quot;</span> <span class="na">value=</span><span class="s">&quot;[Any value can be stored here which will be sent back unchanged in the the 3d secure response e.g to preserve the session id which we can send back to complete the transaction]&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;TermUrl&quot;</span> <span class="na">value=</span><span class="s">&quot;[return URL on your site]&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;noscript&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;Submit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/noscript&gt;</span>
</span><span class='line'><span class="nt">&lt;/form&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>termUrl</code>: the URL that we need to direct the user to, after the user submits the form.</p>

<p>See an example of an ACS (Access Control Server) Form</p>

<p>We need to submit the form with Javascript:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">autosub</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="s1">&#39;acsform&#39;</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">document</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="nx">autosub</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After the form is submitted, the user is redirected to a 3D Secure page which asks for extra credentials.
Once the user submits the 3D Secure form, he/she gets redirected to the &lsquo;termUrl&rsquo; page with two hidden values
(&lsquo;PaRes&rsquo;, &lsquo;MD&rsquo;) which are used to create the final request to Innovate:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$extraData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;PaRes&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;Authentication response&#39;</span><span class="p">,</span> <span class="c1">// we get this value from hidden fields after redirection to termUrl</span>
</span><span class='line'>    <span class="s1">&#39;session&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="c1">// we get this value from hidden fields after redirection to termUrl</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$finalResponse</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="nv">$client</span><span class="o">-&gt;</span><span class="na">createRemoteRequest</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="nx">Client</span><span class="o">::</span><span class="na">INNOVATE_URL</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$extraData</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then we get the final response which can be checked for payment status &ndash; success or denied:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="mi">200</span> <span class="o">===</span> <span class="nv">$finalResponse</span><span class="o">-&gt;</span><span class="na">getStatusCode</span><span class="p">())</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// payment done</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// authentication failed</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Tests</h2>

<p>We added two types of tests; to run them you need to install the dev dependencies using composer and then run
the test using <a href="http://phpunit.de">PHPUnit</a></p>

<ul>
<li><h3>Functional Test:</h3>

<p>These test the library functionality without sending any real request to Innovate, just hit this on your terminal:</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x">phpunit</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><h3>integration Test</h3>

<p>There are a couple of integration tests that verify that the library works flawlessly by creating
real requests to the Innovate payment gateway. Just use valid test credentials, then create a file
called .innovate.config in the project directory with four parameters:</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$configs</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;storeId&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;xxxxx&#39;</span><span class="p">,</span> <span class="c1">//store Id in Innovate</span>
</span><span class='line'>    <span class="s1">&#39;authenticationKey&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;xxxxxxxxxxx&#39;</span><span class="p">,</span> <span class="c1">//authentication key</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Card info</span>
</span><span class='line'><span class="nv">$cardInfo</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;number&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;xxxxxxxxxxxx&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;cvv&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;XXX&#39;</span><span class="p">,</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// The card which need redirection for 3d secured</span>
</span><span class='line'><span class="nv">$redirectUrlCardInfo</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;number&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;xxxxxxxxxxxx&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;cvv&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;XXX&#39;</span><span class="p">,</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// your ip, it should be in Innovate white list</span>
</span><span class='line'><span class="nv">$ip</span> <span class="o">=</span> <span class="s1">&#39;xxx.xxx.xxx.xxx&#39;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After the setup, just run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x">phpunit tests/Namshi/Innovate/Test/Integration/ServiceTest.php</span>
</span></code></pre></td></tr></table></div></figure>


<p>We hope that you enjoy using Namshi&rsquo;s open source library. We&rsquo;ve been using this library for almost a year and
it&rsquo;s working fine with no issues on our side. As always, any feedback and pull requests are welcome :)</p>
</div>


  <footer>
    <p class="meta">
      
  


<span>
    <span class="byline author vcard">Posted by <a href="/team/#Ayham Alzoubi"><span class="fn">Ayham Alzoubi</span></a></span>&nbsp;
</span>


      








  


<time datetime="2014-09-02T19:23:00+04:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2014</time>
      

<div class="categories">
  
    <a class='category' href='/blog/categories/api/'>API</a>, <a class='category' href='/blog/categories/gateway/'>gateway</a>, <a class='category' href='/blog/categories/payment/'>payment</a>, <a class='category' href='/blog/categories/php/'>php</a>
  
</div>


    </p>
    
      <div class="sharing">
  <div class='shareaholic-canvas' data-app='share_buttons' data-app-id='11351537'></div>
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/09/01/5-devops-practices-you-should-consider-starting-today/" title="Previous Post: 5 DevOps practices you should consider starting today">&laquo; 5 DevOps practices you should consider starting today</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/09/04/newsletter-number-54/" title="Next Post: Newsletter #54">Newsletter #54 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section id="titles">
  <a href="http://namshi.github.io" title="Tech @ Namshi.com"><img id="logo" src="/images/namshi-logo.png" /></a>
  <h1 id="site_title"><a href="http://namshi.github.io" title="Tech @ Namshi.com">Tech @ Namshi.com</a></h1>
</section>

<section id="menu">
  <ul>
    <li><i class="fa fa-home fa-lg"></i><a href="http://namshi.github.io"> Home </a></li>
    <li><i class="fa fa-calendar fa-lg"></i><a href="http://namshi.github.io/archives/"> Archives </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="http://namshi.github.io/about/"> About </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="http://namshi.github.io/team/"> Team </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="http://namshi.github.io/join-us/"> Join Us </a></li>
  </ul>
</section>

<section id="social">
  

  

  

  
    <a href="https://github.com/namshi" title="namshi"><i class="fa fa-github fa-2x"></i></a>
  

  

  
    <a href="https://twitter.com/NamshiDotCom" title="NamshiDotCom"><i class="fa fa-twitter fa-2x"></i></a>
  

  
    <a href="https://facebook.com/NamshiFans" title="NamshiFans"><i class="fa fa-facebook fa-2x"></i></a>
  
  
  <a href="http://namshi.github.io/atom.xml" title="Feed"><i class="fa fa-rss fa-2x"></i></a>

</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/10/30/newsletter-number-62/">Newsletter #62</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/30/a-year-and-a-half-journey-with-namshi-tech/">A Year and a Half Journey With Namshi Tech</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/30/ipc14-wtc14-munich/">Namshi Went to Germany!<br>WebTechCon and International PHPConference 2014</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/27/winston-graylog2-a-new-life-under-namshi/">Winston-graylog2: A New Life Under Namshi</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/23/newsletter-number-61/">Newsletter #61</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/namshi">@namshi</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'namshi',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Namshi -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'namshitechblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://namshi.github.io/blog/2014/09/02/innovate-payment-gate-way-library/';
        var disqus_url = 'http://namshi.github.io/blog/2014/09/02/innovate-payment-gate-way-library/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
